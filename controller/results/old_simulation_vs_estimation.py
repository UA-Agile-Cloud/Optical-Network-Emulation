#!/usr/bin/env python

# Simulation OSNR calculations vs RWA Estimation

from decimal import *
import numpy as np
getcontext().prec = 16

# Simulation results
sim_results = [[104.24474710049552, 66.81304087880255, 40.96035271731918, 29.577753544184457, 25.54581035070497, 25.545810350704965],
[161.75861800892952, 54.624435107872216, 32.76999094158916, 27.21032016227139, 20.325660278577278, 20.325660278577274],
[87.26455031481572, 57.44918399695985, 34.891132950588776, 24.925234402072608, 19.577829075247195, 19.577829075247195],
[79.75700067530097, 38.87555340369922, 25.878006195687902, 22.179729093773105, 17.161125718738884, 17.161125718738884],
[93.35558684789021, 46.677793769264234, 29.765679623127255, 22.662035966981502, 20.076846639319324, 20.076846639319328],
[175.99570100510056, 61.67935602414609, 35.22968175369141, 25.577483825951834, 20.076846639319328, 20.07684663931933],
[126.45831519627576, 53.70720512964265, 34.43963033394788, 27.22741045055552, 27.227410450555524],
[111.93143521901375, 46.30664840996324, 28.832266329080984, 22.772848702120182, 22.772848702120182],
[108.35906484705468, 44.80935096519195, 28.24462719642895, 20.804686079476546, 20.804686079476546],
[82.93281769198506, 40.80619240298298, 27.060511662243304, 21.818557634525195, 21.81855763452519],
[152.88727851865144, 66.96910358059887, 41.27898679313865, 30.76423911119745, 26.704808333515928, 26.704808333515928],
[187.40037345265603, 67.6458037197448, 39.13002034582791, 28.450606519088794, 23.58041015809601, 23.580410158096008],
[107.73937140295207, 63.592931797634996, 34.91039291632809, 24.11310170901682, 20.895229067526113, 20.89522906752611],
[159.44757592888755, 53.48600793052021, 32.04176701232368, 26.64143201362722, 21.46474443247858, 21.46474443247858],
[201.08338446868962, 75.45499095666538, 46.201270898297444, 33.597966191895786, 33.59796619189578],
[91.25584127287875, 44.607789271323774, 29.69870768648002, 25.240555492568664, 25.240555492568667],
[80.32377676148269, 39.15763006371069, 26.066000126657393, 22.331437478234086, 22.331437478234086],
[158.07140413982958, 53.081256950563144, 31.985807336015938, 26.641432013627224, 26.641432013627227],
[202.38135039924302, 75.86223567290291, 46.594714515445055, 37.8290328766315, 37.82903287663151],
[112.6338231240939, 60.674925322942116, 44.4454081121538, 20.990525534127396, 20.990525534127393],
[36.76073736671195, 29.95049474673622, 24.238232690361365, 19.80758495758091, 19.80758495758091],
[69.53802161658842, 53.6554991059116, 32.169287253842796, 23.289979124003597, 23.289979124003597],
[82.37946165004873, 40.15760752028073, 34.24358622489397, 22.73443599742858, 22.73443599742858],
[82.93281769198506, 40.80619240298298, 29.9540994147911, 24.39776720852879, 24.397767208528787],
[246.56431840448585, 118.42716419800367, 73.94138208971894, 53.91843485402636, 53.91843485402635],
[118.28405148234113, 49.179909096440014, 34.822112000687135, 22.758789283256068, 22.758789283256068],
[62.130117708129404, 40.358062029739244, 26.86270823911379, 21.74628844221456, 21.74628844221456],
[82.93281769198506, 40.80619240298298, 29.9540994147911, 24.39776720852879, 21.274062539702424, 21.27406253970242],
[161.003106784613, 70.82085917787096, 39.6089186926627, 24.35885282871594, 17.749323171042935, 17.749323171042935],
[82.37946165004873, 40.15760752028073, 34.24358622489397, 22.73443599742858, 17.749035239306107, 17.749035239306103],
[80.93919026076331, 36.847963646140826, 31.80741630807602, 22.623337703000253, 17.749035239306117, 17.749035239306114],
[130.0157159246732, 55.2235439564501, 34.698186443255544, 25.2961665064687, 25.2961665064687],
[196.8419461136299, 98.42097459205152, 65.86425660810532, 51.24181433359816, 51.24181433359816],
[111.93143521901375, 46.30664840996324, 28.832266329080984, 22.772848702120182, 22.772848702120182],
[137.7515210050535, 55.17629583917842, 34.82119059981056, 27.22227759815455, 27.222277598154548],
[141.27704485402964, 60.85380814129589, 38.42365470208001, 30.043488713675693, 25.22415491683255, 25.224154916832546],
[127.08573925295562, 52.85944529973098, 28.911250327587993, 20.101389476807498, 16.544089556413553, 16.544089556413557],
[130.0157159246732, 55.2235439564501, 34.698186443255544, 27.22741045055551, 22.941510641654347, 20.352054436319808, 20.352054436319804],
[119.16831107359772, 83.10396916390906, 46.890544067793606, 33.85732456991093, 27.8305723868493, 27.8305723868493],
[156.34767621063668, 68.46760785490659, 41.84347532396376, 36.310536434897266, 27.83057238684928, 27.830572386849276],
[60.32084744642252, 39.40389343917546, 29.215936899278258, 21.394639155938485, 18.923791151197992, 18.92379115119799],
[161.66857843620895, 52.59880382404489, 35.6763818293133, 27.029777928162186, 18.491224092424016, 18.491224092424016],
[199.11172019184497, 98.98516530272414, 65.86425660810531, 49.35113224260582, 49.35113224260582],
[78.35188946052806, 39.17594497350627, 26.117296703058017, 19.745770793650948, 19.745770793650948],
[95.99839535620718, 43.87173427846282, 28.432840422945493, 22.569487928732425, 22.56948792873242],
[126.45831519627576, 53.70720512964265, 34.093380198411474, 25.15846824607832, 25.15846824607832],
[80.93919026076331, 36.27430796516307, 23.37514265433033, 18.66695208208511, 15.925768794043174, 15.925768794043174],
[129.26871060029225, 59.56519718379152, 33.83950374840313, 23.63273145282424, 18.29185236000588, 18.29185236000588],
[140.87985961658956, 70.28334783403139, 42.238941609920985, 30.384648233412943, 23.72598686122401, 23.725986861224]]



est_results =[
[158.7807407283097, 95.32100441705681, 59.776272254578224, 43.58021689848128, 36.87583154566821, 36.87583154566821],
[239.76489841421628, 96.28090898558216, 60.158245082353105, 48.04318880972648, 36.88545970006246, 36.88545970006246],
[158.6563693940519, 95.24634044605563, 59.72945010965229, 43.39319186112649, 34.24419024712508, 34.24419024712508],
[162.7577541027762, 80.42540413758404, 53.579290514737735, 43.76111903986354, 34.31577465279194, 34.31577465279193],
[158.7392836168909, 79.36964280685525, 51.59370393582, 39.02893244024903, 33.56273642807481, 33.56273642807481],
[239.76489841421628, 96.08637688781937, 58.18454032795648, 42.583915668130274, 33.58026723833829, 33.58026723833829],
[191.73519426863578, 86.85441530354522, 56.45265769297549, 43.77626876614759, 43.77626876614758],
[194.9010407539236, 88.23892735829307, 56.71344118403685, 43.76483893103986, 43.76483893103986],
[191.78525567553936, 86.8770926962626, 56.15812278763465, 41.65680277168379, 41.65680277168379],
[161.1946952415616, 79.96825922519287, 53.17382650561109, 41.624181939658044, 41.624181939658044],
[191.88537848934408, 86.92244748169689, 54.70350592547252, 40.79358175483644, 34.86478521865748, 34.86478521865749],
[239.89006933005987, 96.13653944350916, 58.21491596867227, 42.606146895162674, 34.864785218657474, 34.864785218657474],
[191.58501004792026, 106.20473526806009, 63.861671308711486, 45.7020343758933, 38.37891241971854, 38.37891241971853],
[239.95265478797978, 96.35630515434899, 60.20535412268854, 48.08081072706686, 38.449111631973835, 38.44911163197383],
[238.43760252465478, 95.84256788671651, 59.760664872936324, 43.69265314353476, 43.69265314353477],
[162.41823337284006, 80.25763276211686, 53.46752146115608, 43.66983117809147, 43.669831178091464],
[162.50311355532747, 80.29957560598447, 53.49546372455187, 43.69265314353474, 43.692653143534734],
[238.37533101942722, 95.8175371825036, 60.03519258944763, 48.005566892385694, 48.00556689238569],
[239.89006933005987, 96.33117309809359, 60.18965110924345, 48.06827008795343, 48.06827008795343],
[191.88537848934408, 100.56723196040109, 71.18856768174948, 43.7316020427075, 43.73160204270751],
[113.38434468072452, 77.38044109058494, 56.640168990926014, 43.7316020427075, 43.7316020427075],
[147.3903119112348, 99.83596746693667, 61.28309554630444, 44.50434935677919, 44.504349356779194],
[162.84599193223644, 80.44694379818493, 63.871733592625944, 44.58573139525777, 44.58573139525777],
[161.4473514972308, 80.09360132270082, 56.51161608168289, 44.59031435062684, 44.59031435062684],
[211.32032849487155, 100.5672319604011, 61.589020134898355, 44.57868411744073, 44.57868411744073],
[193.13272784877734, 87.14005216742136, 60.13318444192095, 41.965617295092244, 41.96561729509224],
[138.86654415438068, 80.9292079298616, 53.601725102436895, 41.95466021493137, 41.95466021493137],
[161.15258586561472, 79.9473688756077, 56.40843890144414, 44.50890271832308, 37.625879965602316, 37.62587996560231],
[243.62472933490665, 113.14699301076777, 71.16999513625541, 49.15074657112014, 37.67503841836029, 37.67503841836029],
[162.63367643323417, 80.34205860552022, 63.78845884302117, 44.52760136777332, 34.893760377014026, 34.893760377014026],
[161.40524212128733, 77.09243391494299, 61.732397611823984, 44.460226386698345, 34.92109230405101, 34.92109230405101],
[195.0537446202559, 88.30806206144533, 56.757875846356434, 41.81754776819254, 41.81754776819254],
[158.9051120625625, 79.45255703177816, 53.243280301401185, 41.82846048935406, 41.82846048935406],
[194.79923817636467, 88.19283755619074, 56.68381807582346, 43.741979260824316, 43.74197926082432],
[191.58501004792026, 86.78638312539199, 56.40843890144415, 43.74197926082434, 43.74197926082434],
[195.15554719780667, 88.35415186354601, 56.78749895456913, 43.82198810657798, 36.29696542278335, 36.29696542278335],
[211.09980115709456, 100.46228311577896, 61.52474774300235, 44.532163184695804, 36.249629787397005, 36.249629787397005],
[195.15554719780667, 88.35415186354601, 56.78749895456913, 43.82198810657798, 36.29696542278335, 31.592537369596617, 31.592537369596613],
[158.82219783972778, 104.98090157260222, 61.33112305018422, 44.43702772973328, 36.19007464293476, 36.19007464293476],
[194.9010407539236, 88.23892735829307, 55.200429575637926, 46.84569043067508, 36.17118136471212, 36.171181364712126],
[138.86654415438068, 81.02775802764732, 57.153407849688875, 42.12907312016338, 35.91377811321481, 35.91377811321482],
[243.81545849977152, 96.79129038081557, 64.60464929212324, 48.517755559552285, 35.97005459988257, 35.97005459988257],
[161.40524212128733, 80.0727109731165, 53.24328030140118, 39.88071454170753, 39.88071454170753],
[158.94656917397901, 79.47328558800854, 52.98219061445437, 39.89111911105002, 39.89111911105002],
[161.48946087317373, 80.11449167228501, 53.271061819716785, 41.70029721438425, 41.70029721438425],
[191.93543989624527, 86.94512487441384, 56.202099390835464, 41.68942360370921, 41.68942360370921],
[161.36313274534328, 80.05182062353202, 53.22938954224328, 41.66767638235896, 34.803423485288604, 34.803423485288604],
[211.09980115709456, 100.46228311577896, 61.52474774300235, 44.33948833937559, 34.77617654638453, 34.776176546384534],
[194.69392527703852, 97.20486605338016, 60.52362508334869, 44.108467132499484, 34.6977716887206, 34.6977716887206]]

difference = []
difference_dB = []

sim_r_dB = [Decimal(10*np.log10(value[-2])) for value in sim_results]
est_r_dB = [Decimal(10*np.log10(value[-2])) for value in est_results]

for i in range(0,len(sim_r_dB)):
	difference_dB.append(est_r_dB[i] - sim_r_dB[i])

for i in range(0,len(sim_results)):
	difference.append(est_results[i][-2] - sim_results[i][-2])

print np.std(difference)
print np.var(difference)
print np.mean(difference)
print np.median(difference)